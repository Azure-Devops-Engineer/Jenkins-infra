apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: keycloak
resources:
  - namespace.yaml
  - keycloak-ingress.yaml
  - https://raw.githubusercontent.com/keycloak/keycloak-quickstarts/latest/kubernetes-examples/keycloak.yaml
patchesStrategicMerge:
- |-
  apiVersion: v1
  kind: Service
  metadata:
    name: keycloak
  spec:
    type: ClusterIP
- |-
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: keycloak
  spec:
    template:
      spec:
        containers:
        - name: keycloak
          env:
          - name: KEYCLOAK_USER
            value: "admin"
          - name: KEYCLOAK_PASSWORD
            value: "admin"
          - name: PROXY_ADDRESS_FORWARDING
            value: "true"
