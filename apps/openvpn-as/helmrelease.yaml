apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: openvpn-as
  namespace: flux-system
spec:
  interval: 15m
  timeout: 8m
  releaseName: openvpn
  targetNamespace: openvpn
  storageNamespace: openvpn
  dependsOn:
    - name: public-ingress
  chart:
    spec:
      chart: openvpn-as
      version: '^0.1.8'
      sourceRef:
        kind: HelmRepository
        name: stenic
        namespace: flux-system
      interval: 40m
  values:
    openvpn:
      admin:
        user: superuser
        password: changeme-rightnow
      users:
      - user: kingdon
        password: kingdonpw-changeme
    service:
      type: LoadBalancer
    ingress:
      gui:
        enabled: true
        hostName: vpn.hephy.pro
        ingressClassName: public
        annotations: {}
          # kubernetes.io/ingress.class: nginx
          # kubernetes.io/tls-acme: "true"
        tls:
          enabled: true
          secretName: vpn-hephy-pro-tls
      admin:
        enabled: true
        hostName: vpn-admin.hephy.pro
        ingressClassName: public
        annotations: {}
          # kubernetes.io/ingress.class: nginx
          # kubernetes.io/tls-acme: "true"
        tls:
          enabled: true
          secretName: vpn-admin-hephy-pro-tls
